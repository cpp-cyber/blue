Sub PRIMARY(myTable As Object)

  Dim oSel As Object
  oSel = ThisComponent.CurrentSelection
  If oSel.supportsService("com.sun.star.text.TextTableCursor") Then oSel.BackColor = RGB(232, 162, 2)
End Sub

Sub SECONDARY(myTable As Object)

  Dim oSel As Object
  oSel = ThisComponent.CurrentSelection
  If oSel.supportsService("com.sun.star.text.TextTableCursor") Then oSel.BackColor = RGB(178, 178, 178)
End Sub

' CREATE VULN SCAN TABLE
Sub VULNTABLE()

    Dim odoc, otext, ocursor, mytable, tablecursor

    odoc = ThisComponent
    otext = odoc.getText()
    mytable = CreateTable(odoc)
    ocursor = otext.CreateTextCursor()
    ocursor.gotoStart(False)

    otext.insertTextContent(ocursor, myTable, False)
    tablecursor = myTable.createCursorByCellName("A1")
    InsertNextItem("[NAME HERE]", tablecursor, mytable)
    InsertNextItem("", tablecursor, mytable)
    InsertNextItem("", tablecursor, mytable)
    InsertNextItem("Vulnerability", tablecursor, mytable)
    InsertNextItem("Description", tablecursor, mytable)
    InsertNextItem("Remediation Status", tablecursor, mytable)
    InsertNextItem("", tablecursor, mytable)
    InsertNextItem("", tablecursor, mytable)
    InsertNextItem("", tablecursor, mytable)

End Sub

Sub InsertNextItem(what, oCursor, oTable)

    Dim oCell As Object
    sName = oCursor.getRangeName()
    oCelle = oTable.getCellByName(sName)
    oCelle.String = what
    oCursor.goRight(1, False)

End Sub

Function CreateTable(document) As Object

    oTextTable = document.createInstance("com.sun.star.text.TextTable")
    oTextTable.initialize(3, 3)
    oTextTable.HoriOrient = 0
    oTextTable.LeftMargin = 3000
    oTextTable.RightMargin = 3000
    CreateTable = oTextTable

End Function
